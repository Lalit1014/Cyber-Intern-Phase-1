## Detection Use Case: Malware Execution

### Scenario Description
A basic batch file (malware.bat) is executed to simulate malware behavior. It uses PowerShell to send an HTTP request to http://testphp.vulnweb.com, mimicking common command-and-control or beaconing activity.

### Objective
Detect PowerShell-based outbound network communication to external hosts, particularly via suspicious or uncommon command-line use.

### Tools Used
- **SIEM**: ELK Stack
- **Log Source**: Sysmon
- **Lab Setup**: Malware sample executed on test Windows host.

Event ID / Data Source Mapping
|Source|	Event ID / Field|	   Description    |
|------|------------------|-------------------|
|Sysmon|	       1	      | Process execution |

### Detection Logic / Query
``` dsl
event.code:"1" AND process.name:"cmd.exe"
```
The above query filters all the processes created with the name cmd.exe. While analysing the fields one by one in Sysmon or Kibana Discover, we can find the details of malware.bat in one of the logs. This query detects when the Windows Command Prompt (`cmd.exe`) is executed, which can indicate suspicious or malicious activity if launched unexpectedly. It uses Sysmon Event ID 1, which logs all process creation events.

